<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Manage Books - Admin Panel</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

  <div class="container mt-5">
    <h2 class="text-center mb-4 text-primary fw-bold">üìö Manage Books</h2>

    <!-- Messages -->
    {% if messages %}
      {% for message in messages %}
        <div class="alert alert-{{ message.tags|default:'info' }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    {% endif %}

    <!-- Add New Book Form -->
    <div class="card mb-4 shadow-sm">
      <div class="card-header bg-primary text-white fw-semibold">Add New Book</div>
      <div class="card-body">
        <form method="post" action="{% url 'admin_books' %}">
          {% csrf_token %}

          <div class="row mb-3">
            <div class="col-md-6">
              <label for="title" class="form-label fw-semibold">Title</label>
              <input type="text" name="title" id="title" class="form-control" placeholder="Enter book title" required>
            </div>

            <div class="col-md-6">
              <label for="author" class="form-label fw-semibold">Author</label>
              <select name="author" id="author" class="form-select" required>
                <option value="">-- Select Author --</option>
                {% for author in authors %}
                  <option value="{{ author.id }}">{{ author.name }}</option>
                {% endfor %}
              </select>
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-md-6">
              <label for="category" class="form-label fw-semibold">Category</label>
              <select name="category" id="category" class="form-select">
                <option value="">-- Select Category --</option>
                {% for category in categories %}
                  <option value="{{ category.id }}">{{ category.name }}</option>
                {% endfor %}
              </select>
            </div>

            <div class="col-md-6">
              <label class="form-label fw-semibold">Availability</label>
              <select name="is_available" class="form-select" required>
                <option value="True">Available</option>
                <option value="False">Not Available</option>
              </select>
            </div>
          </div>

          <button type="submit" class="btn btn-success w-100">Add Book</button>
        </form>
      </div>
    </div>

    <!-- Book List -->
    <div class="card shadow-sm">
      <div class="card-header bg-secondary text-white fw-semibold">Existing Books</div>
      <div class="card-body p-0">
        {% if books %}
          <div class="table-responsive">
            <table class="table table-striped table-hover mb-0 align-middle">
              <thead class="table-dark">
                <tr>
                  <th>ID</th>
                  <th>Title</th>
                  <th>Author</th>
                  <th>Category</th>
                  <th>Available</th>
                  <th class="text-center">Actions</th>
                </tr>
              </thead>
              <tbody>
                {% for book in books %}
                  <tr>
                    <td>{{ book.id }}</td>
                    <td>{{ book.title }}</td>
                    <td>{{ book.author.name }}</td>
                    <td>{{ book.category.name|default:"‚Äî" }}</td>
                    <td>
                      {% if book.is_available %}
                        <span class="badge bg-success">Yes</span>
                      {% else %}
                        <span class="badge bg-danger">No</span>
                      {% endif %}
                    </td>
                    <td class="text-center">
                      <a href="{% url 'edit_book' book.id %}" class="btn btn-sm btn-warning">Edit</a>
                      <a href="{% url 'delete_book' book.id %}" class="btn btn-sm btn-danger"
                         onclick="return confirm('Are you sure you want to delete this book?');">Delete</a>
                    </td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <p class="text-center p-3 mb-0">No books available in the library.</p>
        {% endif %}
      </div>
    </div>

    <div class="text-center mt-4">
      <a href="{% url 'admin_dashboard' %}" class="btn btn-secondary">‚Üê Back to Admin Dashboard</a>
    </div>

  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
